{# isOpen is provided by the parent (modal) #} 
 <div
   @editor-update.debounce.750ms="getEditorModal().save()"
   x-data="editor('<p>Hello world! :-)</p>')"
   x-init="
   $watch('isOpen', value => value? focus() : null);
   $watch('state', value => value === 'edit'? focus() : null);
   "
   >
    <template x-if="isLoaded()">
    <div class="menu flex gap-2 items-center sticky top-0 bg-white z-10 p-2 border-b border-gray-200">
          {% component "editPreviewTabs" / %}
          <button
            @click="toggleHeading({ level: 1 })"
            :class="{ 'is-active': isActive('heading', { level: 1 }, updatedAt) }"
          >
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heading1-icon lucide-heading-1"><path d="M4 12h8"/><path d="M4 18V6"/><path d="M12 18V6"/><path d="m17 12 3-2v8"/></svg>
          </button>
          <button @click="toggleBold()" :class="{ 'is-active' : isActive('bold', updatedAt) }">
            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bold-icon lucide-bold"><path d="M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8"/></svg>
          </button>
          <button @click="toggleItalic()" :class="{ 'is-active' : isActive('italic', updatedAt) }">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-italic-icon lucide-italic"><line x1="19" x2="10" y1="4" y2="4"/><line x1="14" x2="5" y1="20" y2="20"/><line x1="15" x2="9" y1="4" y2="20"/></svg>
          </button>
          <button @click="toggleCodeBlock()" :class="{ 'is-active' : isActive('codeBlock', updatedAt) }">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code-icon lucide-code"><path d="m16 18 6-6-6-6"/><path d="m8 6-6 6 6 6"/></svg>
          </button>
          <button @click="toggleBulletList()" :class="{ 'is-active' : isActive('bulletList', updatedAt) }" title="Bullet List">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><circle cx="4" cy="6" r="1"/><circle cx="4" cy="12" r="1"/><circle cx="4" cy="18" r="1"/></svg>
          </button>
          <button @click="toggleOrderedList()" :class="{ 'is-active' : isActive('orderedList', updatedAt) }" title="Ordered List">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="10" x2="21" y1="6" y2="6"/><line x1="10" x2="21" y1="12" y2="12"/><line x1="10" x2="21" y1="18" y2="18"/><path d="M4 16h1v-6H4l2-3"/></svg>
          </button>
          <button @click="toggleBlockquote()" :class="{ 'is-active' : isActive('blockquote', updatedAt) }" title="Blockquote">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 15h15"/><path d="M6 9h9"/><path d="M15 9a3 3 0 1 1 0 6"/><path d="M3 9h3v6H3z"/></svg>
          </button>
          <button @click="toggleUnderline()" :class="{ 'is-active' : isActive('underline', updatedAt) }" title="Underline">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3v6a6 6 0 0 0 12 0V3"/><line x1="4" y1="21" x2="20" y2="21"/></svg>
          </button>
          <button @click="toggleStrike()" :class="{ 'is-active' : isActive('strike', updatedAt) }" title="Strikethrough">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 5a4 4 0 0 0-8 0c0 4 8 4 8 8a4 4 0 0 1-8 0"/><line x1="4" x2="20" y1="12" y2="12"/></svg>
          </button>
          <button @click="toggleHighlight()" :class="{ 'is-active' : isActive('highlight', updatedAt) }" title="Highlight">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m11 18 2-2h6"/><path d="m2 22 3-3h6l3-3"/><path d="M3 17v-4"/><path d="M6 14v-1"/><path d="M10 11V9"/><path d="M8 12v-1"/><path d="m14 13 3-3 3 3"/><path d="M11 6 8.6 3.5 6 6"/><path d="m2 2 20 20"/></svg>
          </button>
          <button @click="setLink()" :class="{ 'is-active' : isActive('link', updatedAt) }" title="Set / Edit Link">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/><path d="M8 12h.01"/><path d="M16 12h.01"/></svg>
          </button>
          <button @click="unsetLink()" title="Remove Link">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m18 13 6-6"/><path d="m11 20 6-6"/><path d="M2 9a6 6 0 0 1 10-4"/><path d="M12 15a6 6 0 0 1-10-4"/></svg>
          </button>
          {% component 'select'
           id='code-block-language'
           options=["Plain", "JavaScript", "TypeScript", "Python", "HTML"] 
           onChange="(e)=>setCodeBlock(e.detail.value)"
           / %}
          <!-- <select @change="setCodeBlock($event.target.value)" x-show="isActive('codeBlock', updatedAt)">
            <option value="">Plain</option>
            <option value="javascript">JavaScript</option>
            <option value="typescript">TypeScript</option>
            <option value="python">Python</option>
            <option value="html">HTML</option>
            <option value="css">CSS</option>
            <option value="json">JSON</option>
          </select> -->
        </div>
      </template>
    <!-- Show editor when in edit mode -->
    <div x-show="isEditMode()" x-ref="element"></div>

    <!-- Show preview when in preview mode -->
    <div x-show="isPreviewMode()" x-html="previewContent" class="tiptap"></div>

        {# 
      <!-- Content retrieval demo -->
      <div class="content-controls" style="margin-top: 1rem;">
        <h3>Content Retrieval:</h3>
        <button @click="console.log('HTML:', getHTML())">Log HTML</button>
        <button @click="console.log('JSON:', getJSON())">Log JSON</button>
        <button @click="console.log('Text:', getText())">Log Text</button>
        <button @click="alert(getHTML())">Show HTML</button>
      </div>
        #}
</div>